# 项目备份工具

一个简单易用的项目版本备份工具，支持一键备份、版本管理、快速恢复和自动清理功能。

## 简介

**项目备份工具**是我独立开发的一款文件备份管理软件，旨在解决日常开发和工作中文件丢失、误删、代码混乱等问题。支持一键备份、版本管理、快速恢复等功能，采用Python开发，提供图形界面（GUI）和命令行（CLI）两种使用方式。

## 功能特点

- ✨ **一键备份**：带时间戳的自动备份，支持添加注释
- 📋 **版本管理**：清晰查看所有备份版本
- 🔄 **快速恢复**：一键恢复到指定版本，智能处理权限问题
- 🗑️ **备份清理**：删除不需要的备份，自动管理备份数量
- 🚫 **智能排除**：自动排除不需要备份的文件（如.git、node_modules等）
- 💾 **灵活存储**：支持自定义备份目录和保存位置
- 🖥️ **双界面支持**：命令行界面（CLI）和图形界面（GUI）
- 📦 **一键打包**：提供可直接运行的EXE程序，无需安装Python

## 快速开始

### 方式一：使用EXE程序（推荐新手）

直接使用打包好的可执行程序，无需安装Python：

1. 进入 `dist` 文件夹
2. 双击 `项目备份工具.exe`
3. 选择要备份的目录和保存位置
4. 点击「创建备份」即可

**注意**：首次运行可能会被Windows Defender拦截，点击「更多信息」→「仍要运行」即可。

### 方式二：使用Python源码

需要Python 3.6+环境：

```bash
# 克隆或下载本项目
git clone <项目地址>
cd python备份工具

# 安装依赖（无依赖，使用标准库）
pip install -r requirements.txt

# 运行图形界面
python gui_backup_tool.py

# 或使用命令行
python backup_tool.py --help
```

## 使用方法

### 一、图形界面（GUI）

直接运行图形界面脚本：

```bash
python gui_backup_tool.py
```

#### 界面说明

```
┌─────────────────────────────────────────────────────────────┐
│ 项目备份工具 v1.0                                            │
├─────────────────────────────────────────────────────────────┤
│ 备份设置                                                     │
│  要备份的目录:  [C:\Users\MyProject      ] [浏览...]        │
│  备份保存位置:  [D:\Backups              ] [浏览...]        │
│                                           备份数量: 5 个    │
├─────────────────────────────────────────────────────────────┤
│ [创建备份] [恢复备份] [删除备份] [刷新列表]                  │
├─────────────────────────────────────────────────────────────┤
│ 备份列表                                                     │
│ ┌─────────────────────────────────────────────────────────┐ │
│ │ 版本ID     │ 备份时间          │ 注释      │ 类型        │ │
│ ├─────────────────────────────────────────────────────────┤ │
│ │ v001_xxx   │ 2026-01-21 10:30 │ 初始备份  │ 压缩        │ │
│ │ v002_xxx   │ 2026-01-21 11:00 │ 添加功能A │ 压缩        │ │
│ └─────────────────────────────────────────────────────────┘ │
├─────────────────────────────────────────────────────────────┤
│ 状态栏: 就绪                                                │
└─────────────────────────────────────────────────────────────┘
```

#### 按钮功能

| 按钮 | 功能说明 | 使用方法 |
|------|----------|----------|
| 创建备份 | 将选定目录备份到指定位置 | 点击后输入注释，确定即可 |
| 恢复备份 | 将备份恢复到源目录 | 选择备份项，点击按钮，确认恢复 |
| 删除备份 | 从列表和文件系统中删除备份 | 选择备份项，点击按钮，确认删除 |
| 刷新列表 | 重新加载备份列表 | 手动删除备份文件后使用 |

### 二、命令行界面（CLI）

在项目根目录下运行以下命令：

#### 创建备份

```bash
python backup_tool.py --create
# 或带注释
python backup_tool.py --create --comment "开发完成v1.0"
```

#### 列出所有备份

```bash
python backup_tool.py --list
```

#### 恢复到指定版本

```bash
python backup_tool.py --restore v001_20260121_103000
```

#### 删除指定备份

```bash
python backup_tool.py --delete v001_20260121_103000
```

#### 查看帮助

```bash
python backup_tool.py --help
```

## 配置说明

首次运行时，会自动创建 `config.json` 配置文件：

```json
{
    "source_dir": "D:/测试备份",
    "backup_dir": "D:/python备份之后的数据",
    "auto_exclude": [
        ".git", "node_modules", "__pycache__", ".pytest_cache",
        "venv", ".venv", "env", ".env", ".idea", ".vscode",
        ".DS_Store", "*.pyc", "*.log", "*.tmp", "*.bak",
        "backup_*", "dist", "build", "*.egg-info"
    ],
    "max_backups": 50,
    "compression": true,
    "hash_check": true
}
```

### 配置项说明

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| source_dir | 默认要备份的目录 | 当前目录 |
| backup_dir | 默认备份保存位置 | 父目录/project_backups |
| auto_exclude | 自动排除的文件/文件夹列表 | 见上 |
| max_backups | 最大备份数量，超过自动清理旧备份 | 50 |
| compression | 是否使用压缩模式 | true |
| hash_check | 是否进行哈希校验 | true |

## 项目结构

```
python备份工具/
├── backup_tool.py           # 主程序（命令行版）
├── gui_backup_tool.py       # 图形界面版
├── config.json              # 配置文件（自动生成）
├── README.md                # 说明文档
├── 项目备份工具.spec         # PyInstaller打包配置
│
├── dist/                    # 打包输出目录
│   └── 项目备份工具.exe      # 可执行程序（双击即可运行）
│   └── config.json          # 配置文件副本
│
├── build/                   # PyInstaller构建文件（可删除）
│   └── 项目备份工具/         # 构建中间文件
│
├── __pycache__/             # Python缓存文件（可删除）
```

## 打包说明

本项目已使用PyInstaller打包为Windows可执行程序：

```bash
# 重新打包命令
pyinstaller --name="项目备份工具" --windowed --onefile --clean gui_backup_tool.py

# 打包后的程序位于 dist/ 文件夹
```

## 备份文件命名规则

```
{项目名}_v{版本号}_{时间戳}_{注释}.zip
```

示例：
```
我的项目_v001_20260121_103000_完成用户登录功能.zip
```

## 最佳实践

### 备份策略

1. **重要节点备份**
   - 完成一个功能后
   - 修改配置文件前
   - 重构代码前
   - 下班前

2. **备份位置选择**
   - 建议备份到不同磁盘
   - 可以使用云盘同步文件夹
   - 重要项目可以使用外部存储

3. **注释规范**
   - 简单描述完成的功能
   - 标注版本号或里程碑
   - 方便后续查找和回溯

### 示例注释

```json
# 推荐
"完成了用户登录功能"
"修复了数据库连接问题"
"重构了数据访问层"
"添加了导出功能"

# 不推荐
"备份"
"更新"
"修改"
"111"
```

## 常见问题

### Q: 如何修改备份存储位置？

A: 有两种方式：
- 修改 `config.json` 中的 `source_dir` 和 `backup_dir` 配置项
- 在图形界面中直接点击「浏览...」按钮选择

### Q: 如何添加自定义排除规则？

A: 在 `config.json` 的 `auto_exclude` 列表中添加规则，支持：
- 文件名精确匹配（如：`.git`）
- 扩展名匹配（如：`*.pyc`）
- 路径包含匹配（如：`node_modules`）

### Q: 备份失败怎么办？

A: 检查：
- 磁盘空间是否充足
- 权限是否足够
- 排除规则是否正确
- 是否有文件被其他程序占用

### Q: 恢复时提示权限不足？

A: 程序会自动跳过无法访问的文件，并生成详细报告。您可以：
- 关闭占用文件的程序
- 以管理员身份运行程序
- 手动处理无法恢复的文件

### Q: 可以备份多个不同的项目吗？

A: 可以！每次备份前：
1. 点击「浏览...」选择新的源目录
2. 选择或创建对应的备份目录
3. 创建备份即可

## 技术

- **语言栈**：Python 3.6+
- **GUI框架**：Tkinter + ttk（Python标准库）
- **打包工具**：PyInstaller
- **依赖**：仅标准库，无需额外安装

## 开发历程

作为独立开发者，我从零开始构建了这个项目备份工具：

1. **需求分析**：明确了备份、恢复、版本管理等核心需求
2. **技术选型**：选择Python + Tkinter，实现跨平台和零依赖
3. **核心实现**：
   - 编写 `backup_tool.py` 实现核心备份逻辑
   - 开发 `gui_backup_tool.py` 提供友好界面
   - 设计自动配置和智能排除规则
4. **优化迭代**：
   - 修复权限处理问题
   - 优化大文件处理
   - 改进界面设计
   - 增加打包支持

## 版本历史

- v1.0.0 (2026-01-21)
  - 初始版本发布
  - 支持命令行和图形界面
  - 实现核心备份恢复功能
  - 智能排除和自动清理
  - 提供EXE打包程序
  - 修复权限问题处理

## 许可证

MIT License

## 贡献

欢迎提交Issue和Pull Request！

## 联系方式

如有问题或建议，请在GitHub上提交Issue。

---

**开发者**：[Jay]（独立开发）

**开发时间**：2026年1月

